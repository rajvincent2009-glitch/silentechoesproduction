<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STORY BOARD</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Fonts -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Creepster&family=Nosifer&family=Special+Elite&display=swap');

        /* --- Custom Styles --- */
        body {
            background-color: #000;
            overflow-x: hidden;
            font-family: 'Special Elite', monospace;
            cursor: crosshair;
        }

        .font-horror {
            font-family: 'Nosifer', cursive;
        }
        
        .font-typewriter {
            font-family: 'Special Elite', monospace;
        }

        /* TV Static Background */
        .tv-static {
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
            animation: static-noise 0.2s infinite;
            pointer-events: none;
            z-index: 5;
        }

        @keyframes static-noise {
            0% { transform: translateX(0) translateY(0); }
            10% { transform: translateX(-5%) translateY(5%); }
            20% { transform: translateX(-10%) translateY(5%); }
            30% { transform: translateX(5%) translateY(-5%); }
            40% { transform: translateX(-5%) translateY(15%); }
            50% { transform: translateX(-10%) translateY(5%); }
            60% { transform: translateX(15%) translateY(0); }
            70% { transform: translateX(0) translateY(10%); }
            80% { transform: translateX(-15%) translateY(0); }
            90% { transform: translateX(10%) translateY(5%); }
            100% { transform: translateX(5%) translateY(0); }
        }

        /* Glitch Text Effect */
        .glitch-text {
            position: relative;
        }
        
        .glitch-text::before,
        .glitch-text::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0c0a09; /* Matches container bg roughly */
        }

        .glitch-text::before {
            left: 2px;
            text-shadow: -1px 0 #ff0000;
            clip-path: inset(40% 0 61% 0);
            animation: glitch-anim-2 3s infinite linear alternate-reverse;
        }

        .glitch-text::after {
            left: -2px;
            text-shadow: -1px 0 #00ff00;
            clip-path: inset(10% 0 50% 0);
            animation: glitch-anim 2.5s infinite linear alternate-reverse;
        }

        @keyframes glitch-anim {
            0% { clip-path: inset(10% 0 80% 0); }
            20% { clip-path: inset(60% 0 10% 0); }
            40% { clip-path: inset(40% 0 50% 0); }
            60% { clip-path: inset(80% 0 5% 0); }
            80% { clip-path: inset(20% 0 60% 0); }
            100% { clip-path: inset(70% 0 20% 0); }
        }

        @keyframes glitch-anim-2 {
            0% { clip-path: inset(80% 0 5% 0); }
            20% { clip-path: inset(10% 0 70% 0); }
            40% { clip-path: inset(50% 0 20% 0); }
            60% { clip-path: inset(20% 0 60% 0); }
            80% { clip-path: inset(70% 0 10% 0); }
            100% { clip-path: inset(5% 0 80% 0); }
        }

        /* Blood Drip Hover */
        .blood-drip {
            position: relative;
            overflow: hidden;
            transition: color 0.3s;
            display: inline-block;
        }

        .blood-drip::after {
            content: '';
            position: absolute;
            top: -100%;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #8a0000 70%, transparent 100%);
            transition: top 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            z-index: -1;
            border-radius: 0 0 15px 15px;
            opacity: 0.8;
        }

        .btn-wrapper:hover .blood-drip {
            color: #ffcccc;
            text-shadow: 0 0 8px rgba(255, 0, 0, 0.8);
        }

        .btn-wrapper:hover .blood-drip::after {
            top: -10px;
        }

        /* Fog Animation */
        .fog-container {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0;
            pointer-events: none;
        }
        
        .fog-img {
            position: absolute;
            height: 100vh;
            width: 300vw;
            background: url('https://raw.githubusercontent.com/danielstuart14/CSS_FOG_ANIMATION/master/fog1.png') repeat-x;
            background-size: contain;
            animation: fog 60s linear infinite;
        }
        
        .fog-img-2 {
            position: absolute;
            height: 100vh;
            width: 300vw;
            background: url('https://raw.githubusercontent.com/danielstuart14/CSS_FOG_ANIMATION/master/fog2.png') repeat-x;
            background-size: contain;
            animation: fog 40s linear infinite;
            z-index: 1;
        }

        @keyframes fog {
            0% { transform: translate3d(0, 0, 0); }
            100% { transform: translate3d(-200vw, 0, 0); }
        }

        /* Button Active States managed by JS classes */
        .btn-wrapper.active .icon-main {
            filter: drop-shadow(0 0 10px rgba(220,38,38,0.7));
            transform: scale(1.25) rotate(6deg);
            color: #dc2626; /* red-600 */
        }

        .btn-wrapper.active .icon-ghost {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
            opacity: 0.5;
        }
        
        .btn-wrapper.active .scratch-mark {
            opacity: 1;
            transform: scaleX(1);
        }

        .btn-wrapper.active .blood-drip {
            color: #dc2626;
        }

        /* Global Flicker Class */
        .flicker-mode .bg-layer {
            filter: invert(1);
        }
        .flicker-mode h1 {
            opacity: 0.3;
        }

        /* Title Flickering Animation */
        @keyframes flicker-text {
            0%   { opacity: 1;    text-shadow: 0 0 20px rgba(185, 28, 28, 0.8); }
            5%   { opacity: 0.3;  text-shadow: none; }
            10%  { opacity: 1;    text-shadow: 0 0 20px rgba(185, 28, 28, 0.8); }
            15%  { opacity: 1;    text-shadow: 0 0 20px rgba(185, 28, 28, 0.8); }
            20%  { opacity: 0.3;  text-shadow: none; }
            25%  { opacity: 1;    text-shadow: 0 0 20px rgba(185, 28, 28, 0.8); }
            30%  { opacity: 0.1;  text-shadow: none; }
            35%  { opacity: 1;    text-shadow: 0 0 20px rgba(185, 28, 28, 0.8); }
            70%  { opacity: 0.7;  text-shadow: 0 0 10px rgba(185, 28, 28, 0.5); }
            72%  { opacity: 0.2;  text-shadow: none; }
            74%  { opacity: 0.9;  text-shadow: 0 0 20px rgba(185, 28, 28, 0.8); }
            100% { opacity: 0.9;  text-shadow: 0 0 20px rgba(185, 28, 28, 0.8); }
        }
        
        .title-flicker {
            animation: flicker-text 5s infinite steps(1);
        }
        
        /* Mobile adjustment for nav */
        @media (max-width: 768px) {
            .btn-wrapper span {
                font-size: 0.8rem;
            }
        }

        /* --- STICKY NAV TRANSITIONS --- */
        #sticky-nav .nav-inner,
        #sticky-nav .btn-wrapper,
        #sticky-nav .icon-main,
        #sticky-nav .nav-text,
        #sticky-nav .nav-bg,
        #sticky-nav .nav-logo,
        #sticky-nav .nav-trailer {
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .nav-logo {
            opacity: 0;
            transform: translateY(-20px);
            pointer-events: none;
        }

        /* Show trailer button from the start */
        .nav-trailer {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }

        /* Mobile-friendly trailer button */
        @media (max-width: 768px) {
            .nav-trailer {
                padding: 0.5rem 0.75rem !important;
                font-size: 0.65rem;
                gap: 0.5rem;
            }
        }

        #sticky-nav.scrolled-nav .nav-inner {
            padding-top: 0.25rem;
            padding-bottom: 0.25rem;
        }

        #sticky-nav.scrolled-nav .btn-wrapper {
            padding: 0.25rem 0.5rem;
        }

        #sticky-nav.scrolled-nav .icon-main {
            width: 1.25rem;
            height: 1.25rem;
            transform-origin: center;
        }
        
        #sticky-nav.scrolled-nav .icon-ghost {
            width: 1.25rem; 
            height: 1.25rem;
        }

        #sticky-nav.scrolled-nav .nav-text {
            font-size: 0.75rem;
            opacity: 0.8;
            margin-left: 0.5rem;
        }
        
        #sticky-nav.scrolled-nav .nav-bg {
            background-color: rgba(28, 25, 23, 0.95);
            border-bottom-color: rgba(127, 29, 29, 0.8);
        }

        #sticky-nav.scrolled-nav .nav-logo {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
            font-size: 1.25rem;
        }

        #sticky-nav.scrolled-nav .nav-trailer {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
            padding: 0.25rem 0.75rem;
            font-size: 0.75rem;
        }

    </style>
</head>
<body class="selection:bg-red-900 selection:text-white min-h-screen relative">

    <!-- Flashlight / Vignette Effect -->
    <div id="flashlight" 
         class="pointer-events-none fixed inset-0 z-50 transition-opacity duration-100"
         style="background: radial-gradient(circle 1000px at 50% 50%, transparent 20%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.4) 85%);">
    </div>

    <!-- Background Elements -->
    <div class="absolute inset-0 z-0 overflow-hidden fixed bg-black">
        <div class="fog-container">
            <div class="fog-img"></div>
            <div class="fog-img-2"></div>
        </div>
        <div class="tv-static absolute inset-0 opacity-10 mix-blend-overlay"></div>
        
        <!-- Creepy Background Image -->
        <div id="bg-layer"
             class="bg-layer absolute inset-0 bg-cover bg-center opacity-80 grayscale contrast-125 transition-all duration-100"
             style="background-image: url('https://img.freepik.com/free-photo/corridor-abandoned-asylum-with-grunge-walls_1232-2826.jpg?t=st=1729654209~exp=1729657809~hmac=a476839a896f634354c034988f58097b399201f81d11342674e2a2253018d9e7&w=1380');">
        </div>
    </div>

    <!-- Main Content Area -->
    <div class="relative z-20 flex flex-col items-center min-h-[150vh] px-4 pb-20 pt-8">
        
        <!-- Header (Scrolls away) -->
        <header class="text-center mt-12 mb-12 select-none">
            <h1 id="main-title" class="font-horror text-2xl sm:text-4xl md:text-5xl lg:text-6xl text-red-700 tracking-widest title-flicker transition-opacity duration-100 opacity-90 px-4" style="text-shadow: 0 0 20px rgba(185, 28, 28, 0.5)">
                STORY BOARD
            </h1>
            <p class="font-typewriter text-stone-400 mt-4 tracking-[0.3em] uppercase text-sm font-bold shadow-black drop-shadow-md">
                Erikan Community School // 1998
            </p>
        </header>

        <!-- Navigation (Sticks to top) -->
        <nav id="sticky-nav" class="sticky top-0 z-50 w-full max-w-7xl mx-auto mb-16">
            <!-- Nav Container Background -->
            <div class="nav-bg absolute inset-0 bg-stone-900/90 backdrop-blur-md rounded-lg border-b-2 border-red-900/50 shadow-[0_0_50px_rgba(0,0,0,0.8)] z-0"></div>
            
            <!-- Blood Splatter Decoration -->
            <div class="absolute -top-4 -right-4 w-24 h-24 bg-red-900 rounded-full opacity-60 blur-xl z-0 pointer-events-none"></div>
            
            <!-- Flex Container for Content -->
            <div class="nav-inner relative z-10 flex flex-wrap md:flex-nowrap justify-between items-center p-2 md:p-4 gap-4 border-b border-red-900/30">
                
                <!-- LEFT: Logo -->
                <div class="nav-logo order-1 md:order-1 flex-shrink-0 md:w-32 font-horror text-red-600 text-2xl md:text-3xl tracking-widest">
                     <span class="title-flicker cursor-default select-none block">EERIE</span>
                </div>

                <!-- CENTER: Nav Items -->
                <div class="hidden md:flex order-3 md:order-2 w-full lg:w-auto justify-between lg:justify-center items-center gap-1 md:gap-4 mt-2 md:mt-0">
                    
                    <!-- Home Button -->
                    <a href="index.html" id="btn-home" class="btn-wrapper group relative flex flex-col items-center justify-center p-2 md:p-3 transition-all duration-300 outline-none text-gray-500 hover:text-red-500 no-underline">
                        <div class="mb-1 transition-transform duration-500 relative icon-container flex items-center justify-center">
                            <i data-lucide="home" class="icon-main relative z-10 w-5 h-5 md:w-6 md:h-6 transition-all duration-500"></i>
                            <i data-lucide="home" class="icon-ghost absolute top-0 left-0 text-red-600 opacity-0 transition-all duration-300 blur-sm w-6 h-6 group-hover:opacity-40 group-hover:translate-x-1 group-hover:translate-y-1"></i>
                        </div>
                        <span class="nav-text hidden md:block font-typewriter text-[10px] lg:text-xs tracking-wider uppercase font-bold blood-drip px-1 z-10 whitespace-nowrap" data-text="Home">Home</span>
                        <div class="scratch-mark absolute bottom-0 w-full h-1 bg-gradient-to-r from-transparent via-red-900 to-transparent transition-all duration-500 transform opacity-0 scale-x-0"></div>
                    </a>

                    <!-- M&R Button -->
                    <a href="M&R.html" id="btn-asylum" class="btn-wrapper group relative flex flex-col items-center justify-center p-2 md:p-3 transition-all duration-300 outline-none text-gray-500 hover:text-red-500 no-underline">
                        <div class="mb-1 transition-transform duration-500 relative icon-container flex items-center justify-center">
                            <i data-lucide="skull" class="icon-main relative z-10 w-5 h-5 md:w-6 md:h-6 transition-all duration-500"></i>
                            <i data-lucide="skull" class="icon-ghost absolute top-0 left-0 text-red-600 opacity-0 transition-all duration-300 blur-sm w-6 h-6 group-hover:opacity-40 group-hover:translate-x-1 group-hover:translate-y-1"></i>
                        </div>
                        <span class="nav-text hidden md:block font-typewriter text-[10px] lg:text-xs tracking-wider uppercase font-bold blood-drip px-1 z-10 whitespace-nowrap" data-text="M&R">M&R</span>
                        <div class="scratch-mark absolute bottom-0 w-full h-1 bg-gradient-to-r from-transparent via-red-900 to-transparent transition-all duration-500 transform opacity-0 scale-x-0"></div>
                    </a>

                    <!-- Teaser Button -->
                    <a href="teaser.html" id="btn-visions" class="btn-wrapper group relative flex flex-col items-center justify-center p-2 md:p-3 transition-all duration-300 outline-none text-gray-500 hover:text-red-500 no-underline">
                        <div class="mb-1 transition-transform duration-500 relative icon-container flex items-center justify-center">
                            <i data-lucide="eye" class="icon-main relative z-10 w-5 h-5 md:w-6 md:h-6 transition-all duration-500"></i>
                            <i data-lucide="eye" class="icon-ghost absolute top-0 left-0 text-red-600 opacity-0 transition-all duration-300 blur-sm w-6 h-6 group-hover:opacity-40 group-hover:translate-x-1 group-hover:translate-y-1"></i>
                        </div>
                        <span class="nav-text hidden md:block font-typewriter text-[10px] lg:text-xs tracking-wider uppercase font-bold blood-drip px-1 z-10 whitespace-nowrap" data-text="teaser">teaser</span>
                        <div class="scratch-mark absolute bottom-0 w-full h-1 bg-gradient-to-r from-transparent via-red-900 to-transparent transition-all duration-500 transform opacity-0 scale-x-0"></div>
                    </a>

                    <!-- Story board Button (Active) -->
                    <a href="story.html" id="btn-rituals" class="btn-wrapper group relative flex flex-col items-center justify-center p-2 md:p-3 transition-all duration-300 outline-none text-red-600 active no-underline">
                        <div class="mb-1 transition-transform duration-500 relative icon-container flex items-center justify-center">
                            <i data-lucide="book-open" class="icon-main relative z-10 w-5 h-5 md:w-6 md:h-6 transition-all duration-500"></i>
                            <i data-lucide="book-open" class="icon-ghost absolute top-0 left-0 text-red-600 opacity-0 transition-all duration-300 blur-sm w-6 h-6 group-hover:opacity-40 group-hover:translate-x-1 group-hover:translate-y-1"></i>
                        </div>
                        <span class="nav-text hidden md:block font-typewriter text-[10px] lg:text-xs tracking-wider uppercase font-bold blood-drip px-1 z-10 whitespace-nowrap" data-text="story board">story board</span>
                        <div class="scratch-mark absolute bottom-0 w-full h-1 bg-gradient-to-r from-transparent via-red-900 to-transparent transition-all duration-500 transform opacity-100 scale-x-100"></div>
                    </a>

                    <!-- Behind the scene Button -->
                    <a href="behindscene.html" id="btn-escape" class="btn-wrapper group relative flex flex-col items-center justify-center p-2 md:p-3 transition-all duration-300 outline-none text-gray-500 hover:text-red-500 no-underline">
                        <div class="mb-1 transition-transform duration-500 relative icon-container flex items-center justify-center">
                            <i data-lucide="map" class="icon-main relative z-10 w-5 h-5 md:w-6 md:h-6 transition-all duration-500"></i>
                            <i data-lucide="map" class="icon-ghost absolute top-0 left-0 text-red-600 opacity-0 transition-all duration-300 blur-sm w-6 h-6 group-hover:opacity-40 group-hover:translate-x-1 group-hover:translate-y-1"></i>
                        </div>
                        <span class="nav-text hidden md:block font-typewriter text-[10px] lg:text-xs tracking-wider uppercase font-bold blood-drip px-1 z-10 whitespace-nowrap" data-text="behind the scene">behind the scene</span>
                        <div class="scratch-mark absolute bottom-0 w-full h-1 bg-gradient-to-r from-transparent via-red-900 to-transparent transition-all duration-500 transform opacity-0 scale-x-0"></div>
                    </a>
                </div>

                <!-- RIGHT: Watch Trailer -->
                <div class="order-2 md:order-3 flex-shrink-0 md:w-32 text-right">
                    <a href="trailer.html" class="nav-trailer font-typewriter text-red-500 border border-red-800 hover:bg-red-900/30 hover:text-white px-3 py-2 rounded transition-all duration-300 text-sm uppercase font-bold tracking-wider flex items-center gap-2 group" role="button" aria-label="Watch Trailer">
                        <i data-lucide="play" class="w-4 h-4 fill-red-600 group-hover:fill-white transition-colors"></i>
                        <span class="hidden sm:inline">Trailer</span>
                    </a>
                </div>

            </div>
            
            <!-- Decorations -->
            <div class="hidden md:block absolute -bottom-4 left-10 w-1 h-8 bg-stone-800 shadow-lg"></div>
            <div class="hidden md:block absolute -bottom-4 right-20 w-1 h-8 bg-stone-800 shadow-lg"></div>
        </nav>

        <!-- Mobile Bottom Navigation (Hidden on Desktop) -->
        <nav class="md:hidden fixed bottom-6 left-1/2 -translate-x-1/2 w-[95%] max-w-[420px] z-50">
            <div class="bg-[#151515] rounded-[2.5rem] px-5 py-3 flex items-center justify-between shadow-[0_15px_40px_rgba(0,0,0,0.8)] relative border border-stone-800/30">
                
                <!-- TEASER -->
                <a href="teaser.html" class="flex flex-col items-center gap-1.5 group w-12 no-underline">
                    <i data-lucide="eye" stroke-width="1.5" class="w-5 h-5 text-[#888888] group-hover:text-white transition-colors duration-300"></i>
                    <span class="text-[9px] text-[#888888] group-hover:text-white font-typewriter tracking-[0.15em] transition-colors duration-300">TEASER</span>
                </a>

                <!-- M&R -->
                <a href="M&R.html" class="flex flex-col items-center gap-1.5 group w-12 no-underline">
                    <i data-lucide="skull" stroke-width="1.5" class="w-5 h-5 text-[#888888] group-hover:text-white transition-colors duration-300"></i>
                    <span class="text-[9px] text-[#888888] group-hover:text-white font-typewriter tracking-[0.15em] transition-colors duration-300">M&R</span>
                </a>

                <!-- HOME -->
                <a href="index.html" class="flex flex-col items-center gap-1.5 group w-12 no-underline">
                    <i data-lucide="home" stroke-width="1.5" class="w-5 h-5 text-[#888888] group-hover:text-white transition-colors duration-300"></i>
                    <span class="text-[9px] text-[#888888] group-hover:text-white font-typewriter tracking-[0.15em] transition-colors duration-300">HOME</span>
                </a>

                <!-- STORY (Active/Highlighted State with Circle) -->
                <div class="relative w-12 h-[38px] flex justify-center z-10">
                    <div class="absolute -top-5 flex justify-center items-center">
                        <!-- Glowing Outer Ring -->
                        <div class="absolute w-[76px] h-[76px] rounded-full border border-red-600/60 shadow-[0_0_20px_rgba(220,38,38,0.5)] z-0 pointer-events-none"></div>
                        <!-- Inner Dark Circle -->
                        <a href="story.html" class="relative z-10 w-[66px] h-[66px] bg-[#0d0d0d] rounded-full flex justify-center items-center group transition-transform active:scale-95 no-underline">
                            <i data-lucide="book-open" stroke-width="1.5" class="w-7 h-7 text-[#ff3333] drop-shadow-[0_0_8px_rgba(255,51,51,0.8)]"></i>
                        </a>
                    </div>
                </div>

                <!-- BEHIND -->
                <a href="behindscene.html" class="flex flex-col items-center gap-1.5 group w-12 no-underline">
                    <i data-lucide="map" stroke-width="1.5" class="w-5 h-5 text-[#888888] group-hover:text-white transition-colors duration-300"></i>
                    <span class="text-[9px] text-[#888888] group-hover:text-white font-typewriter tracking-[0.15em] transition-colors duration-300">BEHIND</span>
                </a>
                
            </div>
        </nav>

        <!-- Interactive Horror Storyboard Area -->
        <main class="w-full max-w-7xl relative flex-grow flex flex-col items-center justify-start gap-8 pb-32 px-4 z-20 mt-8">
            <!-- Controls -->
            <div class="w-full flex justify-between items-end border-b border-red-900/30 pb-4">
                <div class="text-left">
                    <h2 class="font-horror text-red-600 text-xl md:text-3xl tracking-wider title-flicker">SEQUENCE MAP</h2>
                    <p class="font-typewriter text-stone-500 text-[10px] md:text-xs tracking-widest uppercase mt-2 font-bold shadow-black drop-shadow-md">Classified Director's Notes</p>
                </div>
            </div>

            <!-- Grid -->
            <div id="storyboard-grid" class="w-full flex flex-col gap-8">
                <!-- Panels will be injected here via JS -->
            </div>
        </main>

        <footer class="w-full text-center text-stone-500 text-xs font-typewriter mt-auto font-bold relative z-20 pb-8">
            <p>RECORDING... // ERROR 0x666 // DISCONNECTED</p>
        </footer>
    </div>

    <!-- Logic Script -->
    <script>
        // Initialize Icons
        lucide.createIcons();

        // Sticky Nav Shrink Logic
        const nav = document.getElementById('sticky-nav');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 100) {
                nav.classList.add('scrolled-nav');
            } else {
                nav.classList.remove('scrolled-nav');
            }
        });

        // Current Active Page Variable
        let activeId = 'rituals';

        // Flashlight Effect
        const flashlight = document.getElementById('flashlight');
        document.addEventListener('mousemove', (e) => {
            const x = e.clientX;
            const y = e.clientY;
            flashlight.style.background = `radial-gradient(circle 1000px at ${x}px ${y}px, transparent 20%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.4) 85%)`;
        });

        // Random Flicker Effect
        setInterval(() => {
            if (Math.random() > 0.85) { 
                document.body.classList.add('flicker-mode');
                
                if (activeId === 'escape') {
                    const activeBtn = document.getElementById('btn-escape');
                    const span = activeBtn ? activeBtn.querySelector('span') : null;
                    if(span) span.classList.add('glitch-text');
                }

                setTimeout(() => {
                    document.body.classList.remove('flicker-mode');
                    
                    if (activeId === 'escape') {
                        const activeBtn = document.getElementById('btn-escape');
                        const span = activeBtn ? activeBtn.querySelector('span') : null;
                        if(span) span.classList.remove('glitch-text');
                    }
                }, 50 + Math.random() * 150);
            }
        }, 3000);

        // --- STORYBOARD APP LOGIC ---
        let panels = [
            {
                id: 'init-1',
                scene: "Prologue",
                imageUrl: "Prologue .jpg",
                description: "Sta. Lucia Academy for Girls is a Catholic school where only female students are enrolli, and their teachers are nuns. The nuns are also responsible for disciplining the students, correcting their mistakes, and guiding them in their faith in God. However, despite this, dark mystery lingers within the school, especially the restroom located on the third floor of one of its buildings."
            },
            {
                id: 'init-2',
                scene: "Scene 1",
                imageUrl: "Scene 1.jpg",
                description: "In 1995, an accident happened involving a female student named Anna. She was one of the students who stayed overnight at the school. Late that night, she woke up to use the restroom. She tried to wake her companions, but no one wanted to go with her, so she decided to go alone. She went to the restroom on the third floor, but as she was about to leave, something happened to her that neither her companions nor the nuns at the school knew about what happened that night."
            },
            {
                id: 'init-3',
                scene: "Scene 2",
                imageUrl: "Scene 2.jpg",
                description: "In 1995, an accident happened involving a female student named Anna. She was one of the students who stayed overnight at the school. Late that night, she woke up to use the restroom. She tried to wake her companions, but no one wanted to go with her, so she decided to go alone. She went to the restroom on the third floor, but as she was about to leave, something happened to her that neither her companions nor the nuns at the school knew about what happened that night."
            },
            {
                id: 'init-4',
                scene: "Scene 3",
                imageUrl: "Episode 3.jpg",
                description: " One night, another incident happened involving a female student named Clara. She was walking down the hallway that evening when she felt that someoneo something was following her. By morning, she was found lying face down on the field, lifeless. The police conducted an investigation, and one officer spoke to Sister Alice about what had happened. Sister Alice said that she saw Mang Fidel on the night the incident happened."
            },
            {
                id: 'init-5',
                scene: "Scene 4",
                imageUrl: "Scene 4.jpg",
                description: "While Joyce and Ms. Pat were talking in the guidance office, Julian, the investigator of the case, suddenly knocked on the door. He and Ms. Pat talked, and they did not believe that Mang Fidel was responsible for what happened to Clara. Ms. Pat knew that Mang Fidel had been working at Sta. Lucia for a long time, and if he had a motive to kill Clara, she questioned why he would only do it now. Julian agreed with her. Because of this, the two of them decided to secretly work together to investigate what really happened on the night the incident occurred."
            },
            {
                id: 'init-6',
                scene: "Scene 5",
                imageUrl: "Scene 9.jpg",
                description: "Sister Mia helped Miss Pat pretend to be a nun so she could enter Sister Alice’s office and get the file she needed to find out the truth about what happened at Sta. Lucia. When she saw a photo, the door suddenly made a sound because Sister Alice was about to enter, but Father Darwin appeared and spoke to Alice. That night, Ms. Pat went to Sister Alice’s house and asked about Erika Sayco."
            },
            {
                id: 'init-7',
                scene: "Scene 6",
                imageUrl: "Scene 10.jpg",
                description: "After their conversation, Miss Pat went to Sta. Lucia to meet Erika. On her way, she saw Erika walking and followed her until they reached the church. They talked there, and Erika told her everything that happened—her own death, Clara’s death, and the death of her mother. After their conversation, Julian suddenly appeared. Miss Pat screamed in fear and ran, and Julian and Erika chased her. Miss Pat ran up to the third floor, where Julian suddenly caught her and tried to strangle her, but Clara appeared out of nowhere. Clara ran toward Erika and pushed her, causing both of them to fall. Erika released Julian, and Miss Pat stood up, crying."
            },
            {
                id: 'init-8',
                scene: "Epilogue",
                imageUrl: "Epilogue .jpg",
                description: "After that night, Miss Pat listened to the recorder and placed her belongings in a box. Before taking the items home, she passed by the school’s church and saw Joyce sitting and crying in front of the pew. Miss Pat called her, and when she looked at Joyce, she was shocked to see that the photo in front of her was her own face. After that, Joyce ran out of the church toward the third floor of the school, and Miss Pat followed her. She caught up to her on the third floor and saw Erika holding Joyces arm, attempting to make her jump, but Ms. Pat immediately stopped her. The End."
            }
        ];

        const generateId = () => Math.random().toString(36).substr(2, 9);
        const grid = document.getElementById('storyboard-grid');

        function renderPanels() {
            grid.innerHTML = '';
            panels.forEach(panel => {
                const div = document.createElement('div');
                div.className = "group relative bg-black/60 border border-stone-800 hover:border-red-900/50 rounded flex flex-col md:flex-row backdrop-blur-md transition-all shadow-[0_0_30px_rgba(0,0,0,0.8)] overflow-hidden";
                
                const imageContent = panel.imageUrl 
                    ? `<img src="${panel.imageUrl}" class="absolute inset-0 w-full h-full object-cover grayscale contrast-125 z-0" alt="Scene image">`
                    : `<div class="flex flex-col items-center gap-2 z-20 w-3/4 opacity-40">
                           <i data-lucide="image-off" class="w-10 h-10 text-stone-600"></i>
                           <span class="text-xs text-stone-500 font-typewriter tracking-widest uppercase cursor-default text-center">No Visual Data</span>
                       </div>`;

                div.innerHTML = `
                    <div class="w-full sm:w-1/2 md:w-2/5 lg:w-[30%] aspect-[3/4] relative border-b md:border-b-0 md:border-r border-stone-800 flex items-center justify-center bg-stone-900/20 overflow-hidden group-hover:bg-red-950/10 transition-colors flex-shrink-0">
                        <div class="absolute inset-0 tv-static opacity-20 pointer-events-none z-10"></div>
                        ${imageContent}
                        <div class="absolute bottom-3 left-3 bg-red-950/90 border border-red-900/50 text-red-500 text-sm font-typewriter px-3 py-1.5 flex items-center gap-2 backdrop-blur-sm shadow-md z-20 rounded-sm">
                            <i data-lucide="clapperboard" class="w-4 h-4"></i>
                            <span class="bg-transparent border-none outline-none text-red-300 p-0 text-sm text-center font-bold inline-block cursor-default">${panel.scene}</span>
                        </div>
                    </div>
                    <div class="p-4 md:p-6 lg:p-8 flex flex-col gap-4 font-typewriter flex-grow">
                        <div class="flex flex-col gap-3 flex-grow">
                            <label class="text-stone-500 text-xs md:text-sm uppercase tracking-widest flex items-center gap-2 font-bold">
                                <i data-lucide="align-left" class="w-4 h-4 text-stone-600"></i> Scene Description
                            </label>
                            <div class="w-full bg-black/50 border border-stone-800/70 p-4 md:p-6 text-stone-300 text-sm md:text-base lg:text-lg rounded leading-relaxed overflow-y-auto cursor-default flex-grow shadow-inner min-h-[150px]">
                                ${panel.description}
                            </div>
                        </div>
                    </div>
                `;
                grid.appendChild(div);
            });
            lucide.createIcons(); // Re-initialize icons
        }

        // Initialize Storyboard
        renderPanels();

    </script>
</body>
</html>